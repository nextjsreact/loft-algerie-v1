const fs = require('fs');
const path = require('path');

// Configuration
const locales = ['en', 'fr', 'ar'];
const baseDir = path.join(__dirname, '../public/locales');

// Clés manquantes identifiées dans l'analyse
const missingKeys = {
  analytics: [
    "detailedFinancialPerformance",
    "expenses", 
    "financial",
    "maintenance",
    "monthlyFinancialTrend",
    "monthlyOccupancyRates",
    "occupancy",
    "occupancyRateTrends",
    "overview",
    "revenue",
    "revenueExpensesByLoft",
    "trackRevenueExpenses"
  ],
  auth: [
    "enterFullName",
    "fullName",
    "haveAccount", 
    "registrationFailed",
    "signUpDescription",
    "signUpTitle",
    "signingUp",
    "unexpectedError"
  ],
  bills: [
    "dayOverdue",
    "daysOverdue", 
    "dueToday",
    "dueTomorrow",
    "failedToLoadAlerts",
    "noUpcomingBills"
  ],
  conversations: [
    "addMembers",
    "conversation",
    "createDirectOrGroup",
    "createdSuccessfully",
    "direct",
    "directMessage",
    "enterGroupName",
    "failedToCreateConversation",
    "failedToSearchUsers",
    "findUserToMessage",
    "group",
    "groupChat",
    "groupName",
    "members",
    "messages",
    "new",
    "newConversation",
    "noConversations",
    "noConversationsMatch",
    "noConversationsYet",
    "noMessages",
    "noMessagesYet",
    "noUsersFound",
    "participant",
    "participants",
    "searchByNameOrEmail",
    "searchConversations",
    "searchResults",
    "searching",
    "selectAtLeastOneUser",
    "selectConversation",
    "selectConversationDesc",
    "selectedMembers",
    "selectedUser",
    "sendInstructions",
    "someone",
    "startConversation",
    "startConversationDesc",
    "startNewConversation",
    "typeMessage",
    "unknownUser",
    "you"
  ],
  dashboard: [
    "actionRequired",
    "allCaughtUp",
    "attentionNeeded",
    "completed",
    "errorLoadingData",
    "errorLoadingYour",
    "expenses",
    "myProfile",
    "myRecentTasks",
    "needHelp",
    "noTasksAssigned",
    "noTasksYet",
    "noUrgentTasks",
    "quickActions",
    "revenue",
    "someDataError",
    "unableToLoadData",
    "unableToLoadTasks",
    "urgentTasks",
    "viewAllMyTasks",
    "viewMyTasks"
  ],
  executive: [
    "accessDenied",
    "accessDeniedDesc",
    "activeAlerts",
    "averagePrice",
    "cashFlow",
    "companyRevenue",
    "companyShare",
    "confidential",
    "criticalAlerts",
    "executiveLevelRequired",
    "executiveOnly",
    "expenses",
    "financialTrends",
    "financialTrendsDesc",
    "growth",
    "maintenanceCosts",
    "margin",
    "monthlyCashFlow",
    "netProfit",
    "occupancyRate",
    "onTotalRevenue",
    "profit",
    "realEstatePortfolio",
    "revenue",
    "revenueDistribution",
    "revenueDistributionDesc",
    "secured",
    "security",
    "subtitle",
    "systemStatus",
    "thirdPartyRevenue",
    "title",
    "totalLofts",
    "totalRevenue",
    "trend",
    "vsLastMonth",
    "yearOverYearDesc",
    "yearOverYearPerformance"
  ],
  internetConnections: [
    "connectionDetails",
    "costPlaceholder",
    "create",
    "createNewConnectionType",
    "editConnectionType",
    "enterConnectionInfo",
    "providerPlaceholder",
    "saveChanges",
    "speed",
    "speedPlaceholder",
    "status",
    "statusPlaceholder",
    "title",
    "type",
    "typePlaceholder",
    "updateConnectionInfo"
  ],
  landing: [
    "features.financial.description",
    "features.financial.title",
    "features.notifications.description",
    "features.notifications.title",
    "features.property.description",
    "features.property.title",
    "features.tasks.description",
    "features.tasks.title",
    "features.title",
    "getStarted",
    "signIn"
  ],
  lofts: [
    "allOwners",
    "allStatuses",
    "allZoneAreas",
    "billingSections.energy",
    "billingSections.gas",
    "billingSections.internet",
    "billingSections.phone",
    "billingSections.tv",
    "billingSections.water",
    "couldNotLoadData",
    "deleteCancelled",
    "deleteConfirm",
    "deleteConfirmMessage",
    "deleteConfirmPrompt",
    "deleteConfirmationIncorrect",
    "deleteError",
    "deleteErrorMessage",
    "deleteInProgress",
    "deletingLoftData",
    "energyBillFrequency",
    "filterByOwner",
    "filterByStatus",
    "filterByZoneArea",
    "frequency.bimonthly",
    "frequency.fourMonthly",
    "frequency.monthly",
    "frequency.quarterly",
    "frequency.sixMonthly",
    "frequency.weekly",
    "frequency.yearly",
    "internetBillFrequency",
    "loftDataDeleted",
    "nextEnergyBill",
    "nextInternetBill",
    "nextPhoneBill",
    "nextTvBill",
    "nextWaterBill",
    "noLoftsMatch",
    "phoneBillFrequency",
    "selectFrequency",
    "tvBillFrequency",
    "unknown",
    "waterBillFrequency"
  ],
  notifications: [
    "newMessageFrom",
    "view",
    "viewMembers"
  ],
  owners: [
    "address",
    "cancel",
    "companyOwned",
    "createNewOwner",
    "createOwner",
    "editOwner",
    "email",
    "enterOwnerInfo",
    "name",
    "ownerDetails",
    "ownershipType",
    "phone",
    "saving",
    "selectType",
    "thirdParty",
    "updateOwner",
    "updateOwnerInfo"
  ],
  paymentMethods: [
    "cancel",
    "createNewPaymentMethod",
    "createPaymentMethod",
    "details",
    "editPaymentMethod",
    "enterPaymentInfo",
    "name",
    "paymentDetails",
    "saving",
    "type",
    "updatePaymentMethod",
    "updatePaymentMethodInfo"
  ],
  reports: [
    "customRange",
    "dateRange",
    "downloadReports",
    "endDate",
    "export",
    "exportReports",
    "exporting",
    "format",
    "startDate",
    "thisMonth",
    "thisQuarter",
    "thisWeek",
    "thisYear"
  ],
  reservations: [
    "activities.bookingCancelled",
    "activities.checkinCompleted",
    "activities.hourAgo",
    "activities.hoursAgo",
    "activities.minAgo",
    "activities.newReservation",
    "analytics.guestSatisfaction",
    "analytics.monthlyRevenue",
    "analytics.occupancyRate",
    "analytics.title",
    "analytics.totalReservations",
    "analytics.vsLastMonth",
    "availability.blockDates",
    "availability.chooseLoft",
    "availability.endDate",
    "availability.maintenance",
    "availability.management",
    "availability.minimumStay",
    "availability.other",
    "availability.personalUse",
    "availability.priceOverride",
    "availability.priceOverridePlaceholder",
    "availability.reasonForBlocking",
    "availability.renovation",
    "availability.selectLoft",
    "availability.selectReason",
    "availability.startDate",
    "availability.unblockDates",
    "calendar.agenda",
    "calendar.allDay",
    "calendar.day",
    "calendar.event",
    "calendar.month",
    "calendar.noEventsInRange",
    "calendar.title",
    "calendar.tomorrow",
    "calendar.week",
    "calendar.work_week",
    "calendar.yesterday",
    "details.dates",
    "details.guest",
    "details.loft",
    "details.specialRequests",
    "details.title",
    "details.total",
    "form.available",
    "form.basePrice",
    "form.checkIn",
    "form.checkOut",
    "form.checkingAvailability",
    "form.cleaningFee",
    "form.createReservation",
    "form.creating",
    "form.guest",
    "form.guestCount",
    "form.guestEmail",
    "form.guestInfo",
    "form.guestName",
    "form.guestNationality",
    "form.guestPhone",
    "form.guests",
    "form.loft",
    "form.notAvailable",
    "form.selectLoft",
    "form.serviceFee",
    "form.specialRequests",
    "form.specialRequestsPlaceholder",
    "form.taxes",
    "form.title",
    "form.total",
    "list.title",
    "status.cancelled",
    "status.completed",
    "status.confirmed",
    "status.pending",
    "tabs.analytics",
    "tabs.calendar",
    "tabs.list",
    "upcoming.empty",
    "upcoming.title"
  ],
  settings: [
    "accountDeletion",
    "accountDeletionDesc",
    "categories.addNew",
    "categories.allCategories",
    "categories.categoryDetails",
    "categories.categoryName",
    "categories.categoryType",
    "categories.createCategory",
    "categories.createNewCategory",
    "categories.deleteConfirm",
    "categories.description",
    "categories.descriptionPlaceholder",
    "categories.editCategory",
    "categories.enterCategoryInfo",
    "categories.expenseCategories",
    "categories.incomeCategories",
    "categories.manageCategoriesExpense",
    "categories.manageCategoriesIncome",
    "categories.namePlaceholder",
    "categories.noExpenseCategories",
    "categories.noIncomeCategories",
    "categories.saveChanges",
    "categories.saveError",
    "categories.selectType",
    "categories.subtitle",
    "categories.updateCategoryInfo",
    "changePassword",
    "configureNotifications",
    "confirmPassword",
    "currencies.addFirstCurrency",
    "currencies.addNew",
    "currencies.allCurrencies",
    "currencies.default",
    "currencies.defaultCurrency",
    "currencies.defaultCurrencyDesc",
    "currencies.noCurrenciesFound",
    "currencies.setAsDefault",
    "currencies.subtitle",
    "currentPassword",
    "dataExport",
    "dataExportDesc",
    "dataPrivacy",
    "deleteAccount",
    "dueDateReminders",
    "dueDateRemindersDesc",
    "email",
    "enable",
    "exportData",
    "financialReports",
    "financialReportsDesc",
    "fullName",
    "manageAccountSecurity",
    "manageDataPrivacy",
    "managePaymentMethods",
    "managePaymentMethodsBtn",
    "newPassword",
    "notifications",
    "paymentMethods",
    "paymentMethods.addFirstMethod",
    "paymentMethods.addPaymentMethod",
    "paymentMethods.additionalDetails",
    "paymentMethods.createdOn",
    "paymentMethods.existingMethods",
    "paymentMethods.noMethodsFound",
    "paymentMethods.subtitle",
    "profileInfo",
    "role",
    "security",
    "taskAssignments",
    "taskAssignmentsDesc",
    "updatePersonalInfo",
    "updateProfile",
    "zoneAreas.addFirstZoneArea",
    "zoneAreas.addNew",
    "zoneAreas.createNewZoneArea",
    "zoneAreas.existingZoneAreas",
    "zoneAreas.noZoneAreasFound",
    "zoneAreas.refreshError",
    "zoneAreas.updateZoneAreaInfo"
  ],
  tasks: [
    "assignTo",
    "cancel",
    "createError",
    "createSuccess",
    "createTask",
    "editTask",
    "fillTaskInformation",
    "filters.allStatuses",
    "filters.endDate",
    "filters.filterByStatus",
    "filters.startDate",
    "form.addNewTask",
    "form.createNewTask",
    "form.editTask",
    "form.updateStatusDescription",
    "form.updateTaskInfo",
    "form.updateTaskStatus",
    "memberCanOnlyUpdateStatus",
    "noDueDate",
    "noTasks",
    "saving",
    "status.completed",
    "status.inProgress",
    "status.todo",
    "taskDescription",
    "taskDetails",
    "taskDueDate",
    "taskStatus",
    "taskTitle",
    "updateError",
    "updateStatus",
    "updateSuccess",
    "updateTask",
    "viewTask"
  ],
  teams: [
    "addNewTeam",
    "cancel",
    "createTeam",
    "description",
    "editTeam",
    "enterTeamInfo",
    "saving",
    "teamDetails",
    "teamName",
    "updateTeam",
    "updateTeamInfo"
  ],
  transactions: [
    "addCategory",
    "addError",
    "addNewCategory",
    "categoryLabel",
    "categoryPlaceholder",
    "completed",
    "createNewTransaction",
    "createTransaction",
    "date",
    "description",
    "editTransaction",
    "enterAmount",
    "enterTransactionInfo",
    "expenses",
    "failed",
    "fillAllFields",
    "howItWorks",
    "howItWorksSteps.step1",
    "howItWorksSteps.step2",
    "howItWorksSteps.step3",
    "howItWorksSteps.step4",
    "loadingError",
    "pending",
    "referenceAmountDZD",
    "referenceAmountsTitle",
    "selectType",
    "status",
    "transactionDetails",
    "transactionType",
    "updateError",
    "updateSuccess",
    "updateTransaction",
    "updateTransactionInfo"
  ],
  unauthorized: [
    "accessDenied",
    "backToDashboard",
    "noPermission"
  ]
};

// Traductions par défaut (en anglais)
const defaultTranslations = {
  analytics: {
    detailedFinancialPerformance: "Detailed Financial Performance",
    expenses: "Expenses",
    financial: "Financial",
    maintenance: "Maintenance",
    monthlyFinancialTrend: "Monthly Financial Trend",
    monthlyOccupancyRates: "Monthly Occupancy Rates",
    occupancy: "Occupancy",
    occupancyRateTrends: "Occupancy Rate Trends",
    overview: "Overview",
    revenue: "Revenue",
    revenueExpensesByLoft: "Revenue & Expenses by Loft",
    trackRevenueExpenses: "Track revenue and expenses by loft for effective financial management."
  },
  auth: {
    enterFullName: "Enter your full name",
    fullName: "Full Name",
    haveAccount: "Already have an account?",
    registrationFailed: "Registration failed. Please try again.",
    signUpDescription: "Create a new account",
    signUpTitle: "Sign Up",
    signingUp: "Signing up...",
    unexpectedError: "An unexpected error occurred. Please try again."
  },
  bills: {
    dayOverdue: "day overdue",
    daysOverdue: "days overdue",
    dueToday: "Due today",
    dueTomorrow: "Due tomorrow",
    failedToLoadAlerts: "Failed to load bill alerts.",
    noUpcomingBills: "No upcoming bills at the moment. Relax!"
  },
  conversations: {
    addMembers: "Add Members",
    conversation: "Conversation",
    createDirectOrGroup: "Create direct or group conversation",
    createdSuccessfully: "Conversation created successfully!",
    direct: "Direct",
    directMessage: "Direct Message",
    enterGroupName: "Enter group name",
    failedToCreateConversation: "Failed to create conversation",
    failedToSearchUsers: "Failed to search users",
    findUserToMessage: "Find user to message",
    group: "Group",
    groupChat: "Group Chat",
    groupName: "Group Name",
    members: "Members",
    messages: "Messages",
    new: "New",
    newConversation: "New Conversation",
    noConversations: "No conversations",
    noConversationsMatch: "No conversations match your search",
    noConversationsYet: "No conversations yet",
    noMessages: "No messages",
    noMessagesYet: "No messages yet",
    noUsersFound: "No users found",
    participant: "Participant",
    participants: "Participants",
    searchByNameOrEmail: "Search by name or email",
    searchConversations: "Search conversations",
    searchResults: "Search Results",
    searching: "Searching...",
    selectAtLeastOneUser: "Select at least one user",
    selectConversation: "Select Conversation",
    selectConversationDesc: "Choose a conversation to start messaging",
    selectedMembers: "Selected Members",
    selectedUser: "Selected User",
    sendInstructions: "Send instructions",
    someone: "Someone",
    startConversation: "Start Conversation",
    startConversationDesc: "Begin a new conversation",
    startNewConversation: "Start New Conversation",
    typeMessage: "Type a message...",
    unknownUser: "Unknown User",
    you: "You"
  },
  dashboard: {
    actionRequired: "Action Required",
    allCaughtUp: "All caught up!",
    attentionNeeded: "Attention needed",
    completed: "Completed",
    errorLoadingData: "Error loading data",
    errorLoadingYour: "Error loading your dashboard",
    expenses: "Expenses",
    myProfile: "My Profile",
    myRecentTasks: "My Recent Tasks",
    needHelp: "Need help?",
    noTasksAssigned: "No tasks assigned",
    noTasksYet: "No tasks yet",
    noUrgentTasks: "No urgent tasks",
    quickActions: "Quick Actions",
    revenue: "Revenue",
    someDataError: "Some data couldn't be loaded",
    unableToLoadData: "Unable to load dashboard data. Please try refreshing the page.",
    unableToLoadTasks: "Unable to load your tasks and dashboard data. Please try refreshing the page.",
    urgentTasks: "Urgent Tasks",
    viewAllMyTasks: "View All My Tasks",
    viewMyTasks: "View My Tasks"
  },
  executive: {
    accessDenied: "Access Denied",
    accessDeniedDesc: "You don't have permission to view this page",
    activeAlerts: "Active Alerts",
    averagePrice: "Average Price",
    cashFlow: "Cash Flow",
    companyRevenue: "Company Revenue",
    companyShare: "Company Share",
    confidential: "Confidential",
    criticalAlerts: "Critical Alerts",
    executiveLevelRequired: "Executive level required",
    executiveOnly: "Executive Only",
    expenses: "Expenses",
    financialTrends: "Financial Trends",
    financialTrendsDesc: "Track revenue and expense trends over time",
    growth: "Growth",
    maintenanceCosts: "Maintenance Costs",
    margin: "Margin",
    monthlyCashFlow: "Monthly Cash Flow",
    netProfit: "Net Profit",
    occupancyRate: "Occupancy Rate",
    onTotalRevenue: "on total revenue",
    profit: "Profit",
    realEstatePortfolio: "Real Estate Portfolio",
    revenue: "Revenue",
    revenueDistribution: "Revenue Distribution",
    revenueDistributionDesc: "Breakdown of revenue by source",
    secured: "Secured",
    security: "Security",
    subtitle: "Executive dashboard for high-level insights",
    systemStatus: "System Status",
    thirdPartyRevenue: "Third Party Revenue",
    title: "Executive Dashboard",
    totalLofts: "Total Lofts",
    totalRevenue: "Total Revenue",
    trend: "Trend",
    vsLastMonth: "vs last month",
    yearOverYearDesc: "Year over year performance comparison",
    yearOverYearPerformance: "Year over Year Performance"
  },
  internetConnections: {
    connectionDetails: "Connection Details",
    costPlaceholder: "Enter cost",
    create: "Create",
    createNewConnectionType: "Create New Connection Type",
    editConnectionType: "Edit Connection Type",
    enterConnectionInfo: "Enter connection information",
    providerPlaceholder: "Enter provider name",
    saveChanges: "Save Changes",
    speed: "Speed",
    speedPlaceholder: "Enter speed",
    status: "Status",
    statusPlaceholder: "Enter status",
    title: "Internet Connections",
    type: "Type",
    typePlaceholder: "Enter type",
    updateConnectionInfo: "Update connection information"
  },
  landing: {
    "features.financial.description": "Track revenue, expenses, and financial performance",
    "features.financial.title": "Financial Management",
    "features.notifications.description": "Stay informed with real-time alerts and notifications",
    "features.notifications.title": "Smart Notifications",
    "features.property.description": "Manage all your properties in one place",
    "features.property.title": "Property Management",
    "features.tasks.description": "Assign and track tasks with your team",
    "features.tasks.title": "Task Management",
    "features.title": "Features",
    getStarted: "Get Started",
    signIn: "Sign In"
  },
  lofts: {
    allOwners: "All Owners",
    allStatuses: "All Statuses",
    allZoneAreas: "All Zone Areas",
    "billingSections.energy": "Energy",
    "billingSections.gas": "Gas",
    "billingSections.internet": "Internet",
    "billingSections.phone": "Phone",
    "billingSections.tv": "TV",
    "billingSections.water": "Water",
    couldNotLoadData: "Could not load data",
    deleteCancelled: "Delete cancelled",
    deleteConfirm: "Delete Confirmation",
    deleteConfirmMessage: "Are you sure you want to delete this loft?",
    deleteConfirmPrompt: "Type 'DELETE' to confirm",
    deleteConfirmationIncorrect: "Confirmation text is incorrect",
    deleteError: "Delete Error",
    deleteErrorMessage: "Failed to delete loft. Please try again.",
    deleteInProgress: "Deleting...",
    deletingLoftData: "Deleting loft data...",
    energyBillFrequency: "Energy Bill Frequency",
    filterByOwner: "Filter by Owner",
    filterByStatus: "Filter by Status",
    filterByZoneArea: "Filter by Zone Area",
    "frequency.bimonthly": "Bimonthly",
    "frequency.fourMonthly": "Four Monthly",
    "frequency.monthly": "Monthly",
    "frequency.quarterly": "Quarterly",
    "frequency.sixMonthly": "Six Monthly",
    "frequency.weekly": "Weekly",
    "frequency.yearly": "Yearly",
    internetBillFrequency: "Internet Bill Frequency",
    loftDataDeleted: "Loft data deleted successfully",
    nextEnergyBill: "Next Energy Bill",
    nextInternetBill: "Next Internet Bill",
    nextPhoneBill: "Next Phone Bill",
    nextTvBill: "Next TV Bill",
    nextWaterBill: "Next Water Bill",
    noLoftsMatch: "No lofts match your search",
    phoneBillFrequency: "Phone Bill Frequency",
    selectFrequency: "Select Frequency",
    tvBillFrequency: "TV Bill Frequency",
    unknown: "Unknown",
    waterBillFrequency: "Water Bill Frequency"
  },
  notifications: {
    newMessageFrom: "New message from",
    view: "View",
    viewMembers: "View Members"
  },
  owners: {
    address: "Address",
    cancel: "Cancel",
    companyOwned: "Company Owned",
    createNewOwner: "Create New Owner",
    createOwner: "Create Owner",
    editOwner: "Edit Owner",
    email: "Email",
    enterOwnerInfo: "Enter owner information",
    name: "Name",
    ownerDetails: "Owner Details",
    ownershipType: "Ownership Type",
    phone: "Phone",
    saving: "Saving...",
    selectType: "Select Type",
    thirdParty: "Third Party",
    updateOwner: "Update Owner",
    updateOwnerInfo: "Update owner information"
  },
  paymentMethods: {
    cancel: "Cancel",
    createNewPaymentMethod: "Create New Payment Method",
    createPaymentMethod: "Create Payment Method",
    details: "Details",
    editPaymentMethod: "Edit Payment Method",
    enterPaymentInfo: "Enter payment information",
    name: "Name",
    paymentDetails: "Payment Details",
    saving: "Saving...",
    type: "Type",
    updatePaymentMethod: "Update Payment Method",
    updatePaymentMethodInfo: "Update payment method information"
  },
  reports: {
    customRange: "Custom Range",
    dateRange: "Date Range",
    downloadReports: "Download Reports",
    endDate: "End Date",
    export: "Export",
    exportReports: "Export Reports",
    exporting: "Exporting...",
    format: "Format",
    startDate: "Start Date",
    thisMonth: "This Month",
    thisQuarter: "This Quarter",
    thisWeek: "This Week",
    thisYear: "This Year"
  },
  reservations: {
    "activities.bookingCancelled": "Booking cancelled",
    "activities.checkinCompleted": "Check-in completed",
    "activities.hourAgo": "hour ago",
    "activities.hoursAgo": "hours ago",
    "activities.minAgo": "min ago",
    "activities.newReservation": "New reservation",
    "analytics.guestSatisfaction": "Guest Satisfaction",
    "analytics.monthlyRevenue": "Monthly Revenue",
    "analytics.occupancyRate": "Occupancy Rate",
    "analytics.title": "Reservation Analytics",
    "analytics.totalReservations": "Total Reservations",
    "analytics.vsLastMonth": "vs last month",
    "availability.blockDates": "Block Dates",
    "availability.chooseLoft": "Choose Loft",
    "availability.endDate": "End Date",
    "availability.maintenance": "Maintenance",
    "availability.management": "Management",
    "availability.minimumStay": "Minimum Stay",
    "availability.other": "Other",
    "availability.personalUse": "Personal Use",
    "availability.priceOverride": "Price Override",
    "availability.priceOverridePlaceholder": "Enter price override",
    "availability.reasonForBlocking": "Reason for Blocking",
    "availability.renovation": "Renovation",
    "availability.selectLoft": "Select Loft",
    "availability.selectReason": "Select Reason",
    "availability.startDate": "Start Date",
    "availability.unblockDates": "Unblock Dates",
    "calendar.agenda": "Agenda",
    "calendar.allDay": "All Day",
    "calendar.day": "Day",
    "calendar.event": "Event",
    "calendar.month": "Month",
    "calendar.noEventsInRange": "No events in range",
    "calendar.title": "Calendar",
    "calendar.tomorrow": "Tomorrow",
    "calendar.week": "Week",
    "calendar.work_week": "Work Week",
    "calendar.yesterday": "Yesterday",
    "details.dates": "Dates",
    "details.guest": "Guest",
    "details.loft": "Loft",
    "details.specialRequests": "Special Requests",
    "details.title": "Reservation Details",
    "details.total": "Total",
    "form.available": "Available",
    "form.basePrice": "Base Price",
    "form.checkIn": "Check In",
    "form.checkOut": "Check Out",
    "form.checkingAvailability": "Checking availability...",
    "form.cleaningFee": "Cleaning Fee",
    "form.createReservation": "Create Reservation",
    "form.creating": "Creating...",
    "form.guest": "Guest",
    "form.guestCount": "Guest Count",
    "form.guestEmail": "Guest Email",
    "form.guestInfo": "Guest Information",
    "form.guestName": "Guest Name",
    "form.guestNationality": "Guest Nationality",
    "form.guestPhone": "Guest Phone",
    "form.guests": "Guests",
    "form.loft": "Loft",
    "form.notAvailable": "Not Available",
    "form.selectLoft": "Select Loft",
    "form.serviceFee": "Service Fee",
    "form.specialRequests": "Special Requests",
    "form.specialRequestsPlaceholder": "Enter special requests...",
    "form.taxes": "Taxes",
    "form.title": "New Reservation",
    "form.total": "Total",
    "list.title": "Reservations",
    "status.cancelled": "Cancelled",
    "status.completed": "Completed",
    "status.confirmed": "Confirmed",
    "status.pending": "Pending",
    "tabs.analytics": "Analytics",
    "tabs.calendar": "Calendar",
    "tabs.list": "List",
    "upcoming.empty": "No upcoming reservations",
    "upcoming.title": "Upcoming Reservations"
  },
  settings: {
    accountDeletion: "Account Deletion",
    accountDeletionDesc: "Permanently delete your account and all associated data",
    "categories.addNew": "Add New",
    "categories.allCategories": "All Categories",
    "categories.categoryDetails": "Category Details",
    "categories.categoryName": "Category Name",
    "categories.categoryType": "Category Type",
    "categories.createCategory": "Create Category",
    "categories.createNewCategory": "Create New Category",
    "categories.deleteConfirm": "Delete Confirmation",
    "categories.description": "Description",
    "categories.descriptionPlaceholder": "Enter description",
    "categories.editCategory": "Edit Category",
    "categories.enterCategoryInfo": "Enter category information",
    "categories.expenseCategories": "Expense Categories",
    "categories.incomeCategories": "Income Categories",
    "categories.manageCategoriesExpense": "Manage Expense Categories",
    "categories.manageCategoriesIncome": "Manage Income Categories",
    "categories.namePlaceholder": "Enter name",
    "categories.noExpenseCategories": "No expense categories found",
    "categories.noIncomeCategories": "No income categories found",
    "categories.saveChanges": "Save Changes",
    "categories.saveError": "Error saving category",
    "categories.selectType": "Select Type",
    "categories.subtitle": "Manage transaction categories",
    "categories.updateCategoryInfo": "Update category information",
    changePassword: "Change Password",
    configureNotifications: "Configure Notifications",
    confirmPassword: "Confirm Password",
    "currencies.addFirstCurrency": "Add First Currency",
    "currencies.addNew": "Add New",
    "currencies.allCurrencies": "All Currencies",
    "currencies.default": "Default",
    "currencies.defaultCurrency": "Default Currency",
    "currencies.defaultCurrencyDesc": "Set the default currency for transactions",
    "currencies.noCurrenciesFound": "No currencies found",
    "currencies.setAsDefault": "Set as Default",
    "currencies.subtitle": "Manage currencies",
    currentPassword: "Current Password",
    dataExport: "Data Export",
    dataExportDesc: "Export your data for backup or analysis",
    dataPrivacy: "Data Privacy",
    deleteAccount: "Delete Account",
    dueDateReminders: "Due Date Reminders",
    dueDateRemindersDesc: "Get notified about upcoming bills and payments",
    email: "Email",
    enable: "Enable",
    exportData: "Export Data",
    financialReports: "Financial Reports",
    financialReportsDesc: "Generate and view financial reports",
    fullName: "Full Name",
    manageAccountSecurity: "Manage Account Security",
    manageDataPrivacy: "Manage Data Privacy",
    managePaymentMethods: "Manage Payment Methods",
    managePaymentMethodsBtn: "Manage Payment Methods",
    newPassword: "New Password",
    notifications: "Notifications",
    paymentMethods: "Payment Methods",
    "paymentMethods.addFirstMethod": "Add First Method",
    "paymentMethods.addPaymentMethod": "Add Payment Method",
    "paymentMethods.additionalDetails": "Additional Details",
    "paymentMethods.createdOn": "Created On",
    "paymentMethods.existingMethods": "Existing Methods",
    "paymentMethods.noMethodsFound": "No methods found",
    "paymentMethods.subtitle": "Manage payment methods",
    profileInfo: "Profile Information",
    role: "Role",
    security: "Security",
    taskAssignments: "Task Assignments",
    taskAssignmentsDesc: "Manage task assignments and notifications",
    updatePersonalInfo: "Update Personal Information",
    updateProfile: "Update Profile",
    "zoneAreas.addFirstZoneArea": "Add First Zone Area",
    "zoneAreas.addNew": "Add New",
    "zoneAreas.createNewZoneArea": "Create New Zone Area",
    "zoneAreas.existingZoneAreas": "Existing Zone Areas",
    "zoneAreas.noZoneAreasFound": "No zone areas found",
    "zoneAreas.refreshError": "Error refreshing zone areas",
    "zoneAreas.updateZoneAreaInfo": "Update zone area information"
  },
  tasks: {
    assignTo: "Assign To",
    cancel: "Cancel",
    createError: "Error creating task",
    createSuccess: "Task created successfully",
    createTask: "Create Task",
    editTask: "Edit Task",
    fillTaskInformation: "Fill task information",
    "filters.allStatuses": "All Statuses",
    "filters.endDate": "End Date",
    "filters.filterByStatus": "Filter by Status",
    "filters.startDate": "Start Date",
    "form.addNewTask": "Add New Task",
    "form.createNewTask": "Create New Task",
    "form.editTask": "Edit Task",
    "form.updateStatusDescription": "Update status description",
    "form.updateTaskInfo": "Update task information",
    "form.updateTaskStatus": "Update task status",
    memberCanOnlyUpdateStatus: "Member can only update status",
    noDueDate: "No due date",
    noTasks: "No tasks",
    saving: "Saving...",
    "status.completed": "Completed",
    "status.inProgress": "In Progress",
    "status.todo": "To Do",
    taskDescription: "Task Description",
    taskDetails: "Task Details",
    taskDueDate: "Task Due Date",
    taskStatus: "Task Status",
    taskTitle: "Task Title",
    updateError: "Error updating task",
    updateStatus: "Update Status",
    updateSuccess: "Task updated successfully",
    updateTask: "Update Task",
    viewTask: "View Task"
  },
  teams: {
    addNewTeam: "Add New Team",
    cancel: "Cancel",
    createTeam: "Create Team",
    description: "Description",
    editTeam: "Edit Team",
    enterTeamInfo: "Enter team information",
    saving: "Saving...",
    teamDetails: "Team Details",
    teamName: "Team Name",
    updateTeam: "Update Team",
    updateTeamInfo: "Update team information"
  },
  transactions: {
    addCategory: "Add Category",
    addError: "Error adding transaction",
    addNewCategory: "Add New Category",
    categoryLabel: "Category",
    categoryPlaceholder: "Select category",
    completed: "Completed",
    createNewTransaction: "Create New Transaction",
    createTransaction: "Create Transaction",
    date: "Date",
    description: "Description",
    editTransaction: "Edit Transaction",
    enterAmount: "Enter amount",
    enterTransactionInfo: "Enter transaction information",
    expenses: "Expenses",
    failed: "Failed",
    fillAllFields: "Please fill all required fields",
    howItWorks: "How it works",
    "howItWorksSteps.step1": "Step 1: Select transaction type",
    "howItWorksSteps.step2": "Step 2: Enter amount and details",
    "howItWorksSteps.step3": "Step 3: Choose category and payment method",
    "howItWorksSteps.step4": "Step 4: Save and track your transaction",
    loadingError: "Error loading transactions",
    pending: "Pending",
    referenceAmountDZD: "Reference Amount (DZD)",
    referenceAmountsTitle: "Reference Amounts",
    selectType: "Select Type",
    status: "Status",
    transactionDetails: "Transaction Details",
    transactionType: "Transaction Type",
    updateError: "Error updating transaction",
    updateSuccess: "Transaction updated successfully",
    updateTransaction: "Update Transaction",
    updateTransactionInfo: "Update transaction information"
  },
  unauthorized: {
    accessDenied: "Access Denied",
    backToDashboard: "Back to Dashboard",
    noPermission: "You don't have permission to access this page"
  }
};

// Fonction pour créer un objet imbriqué à partir d'une clé avec des points
function createNestedObject(key, value) {
  const keys = key.split('.');
  const result = {};
  let current = result;
  
  for (let i = 0; i < keys.length - 1; i++) {
    current[keys[i]] = {};
    current = current[keys[i]];
  }
  
  current[keys[keys.length - 1]] = value;
  return result;
}

// Fonction pour fusionner des objets imbriqués
function mergeNestedObjects(target, source) {
  for (const key in source) {
    if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {
      if (!target[key]) target[key] = {};
      mergeNestedObjects(target[key], source[key]);
    } else {
      target[key] = source[key];
    }
  }
  return target;
}

// Fonction pour ajouter les clés manquantes à un fichier JSON
function addMissingKeysToFile(filePath, namespace, missingKeysForNamespace) {
  try {
    let existingData = {};
    if (fs.existsSync(filePath)) {
      const fileContent = fs.readFileSync(filePath, 'utf8');
      existingData = JSON.parse(fileContent);
    }

    const newTranslations = defaultTranslations[namespace] || {};
    const updatedData = mergeNestedObjects(existingData, newTranslations);

    // Créer le répertoire s'il n'existe pas
    const dir = path.dirname(filePath);
    if (!fs.existsSync(dir)) {
      fs.mkdirSync(dir, { recursive: true });
    }

    fs.writeFileSync(filePath, JSON.stringify(updatedData, null, 2));
    console.log(`✅ Updated ${filePath}`);
  } catch (error) {
    console.error(`❌ Error updating ${filePath}:`, error.message);
  }
}

// Fonction principale
function generateMissingTranslations() {
  console.log('🚀 Starting translation generation...\n');

  // Pour chaque namespace
  for (const [namespace, keys] of Object.entries(missingKeys)) {
    console.log(`📝 Processing namespace: ${namespace}`);
    
    // Pour chaque langue
    for (const locale of locales) {
      const filePath = path.join(baseDir, locale, `${namespace}.json`);
      addMissingKeysToFile(filePath, namespace, keys);
    }
  }

  console.log('\n✅ Translation generation completed!');
  console.log('\n📋 Summary:');
  console.log(`- Processed ${Object.keys(missingKeys).length} namespaces`);
  console.log(`- Updated ${locales.length} languages (${locales.join(', ')})`);
  console.log(`- Total files updated: ${Object.keys(missingKeys).length * locales.length}`);
}

// Exécuter le script
if (require.main === module) {
  generateMissingTranslations();
}

module.exports = { generateMissingTranslations };
